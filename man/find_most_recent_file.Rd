% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilities.R
\name{find_most_recent_file}
\alias{find_most_recent_file}
\title{Find most recent Excel file in nested date folders}
\usage{
find_most_recent_file(base_path, file_pattern, year_pattern, month_pattern)
}
\arguments{
\item{base_path}{Character string. Base directory path containing year folders.}

\item{file_pattern}{Character string. Regex pattern to match Excel filenames.
Pattern is anchored at the start and ".xls$" is appended automatically.}

\item{year_pattern}{Character string. Regex pattern to identify year folders
(e.g., "Leto \\\\d{4}" or "\\\\d{4}").}

\item{month_pattern}{Character string. Regex pattern to identify month or
quarter folders (e.g., "\\\\d{2} \\\\d{4}" or "Q\\\\d \\\\d{4}").}
}
\value{
Character string. Full path to the most recent matching Excel file.
}
\description{
Navigates through year and month/quarter folder structures to locate
the most recent Excel file matching a given pattern. Used to find
DESEZONIRANJE files in the standardized O:/DESEZONIRANJE folder structure.
}
\details{
The function assumes a folder structure: base_path/year_folder/month_folder/file.xls
It selects the lexicographically maximum year and month folders (which works
for standard date formats), then finds files matching the pattern.

Stops with error if no matching files found. Issues warning if multiple
files match the pattern (returns first match).
}
\examples{
\dontrun{
find_most_recent_file(
  base_path = "O:/DESEZONIRANJE/Trg dela/ILO/Brezposelni",
  file_pattern = "^ILO brezposelni",
  year_pattern = "\\\\d{4}",
  month_pattern = "Q\\\\d \\\\d{4}"
)
}

}
\keyword{internal}
